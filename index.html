<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>User Dashboard ğŸ’¼</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
<style>
  body {
    background: linear-gradient(120deg, #a1c4fd, #c2e9fb);
    font-family: 'Poppins', sans-serif;
    padding: 30px;
  }
  .dashboard {
    background: #fff;
    border-radius: 20px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    padding: 25px;
  }
  .dashboard h2 {
    text-align: center;
    color: #007bff;
    margin-bottom: 20px;
  }
  .user-card {
    border-radius: 15px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    transition: transform 0.2s, box-shadow 0.2s;
    overflow: hidden;
    position: relative;
  }
  .user-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
  }
  .avatar {
    width: 90px;
    height: 90px;
    border-radius: 50%;
    object-fit: cover;
    margin-top: 10px;
  }
  .favorite {
    position: absolute;
    top: 10px;
    right: 15px;
    cursor: pointer;
    font-size: 1.5rem;
  }
  .favorite:hover {
    transform: scale(1.2);
  }
  .search-input {
    border-radius: 25px;
    padding: 5px 15px;
  }
  .animate__fadeInUp {
    animation-duration: 0.6s;
  }
</style>
</head>
<body>

<div class="dashboard container">
  <h2>ğŸ‘¥ User Dashboard</h2>

  <!-- Search Bar -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <input type="text" id="search" class="form-control search-input w-50" placeholder="ğŸ” Search users...">
    <button class="btn btn-primary" data-bs-toggle="collapse" data-bs-target="#formSection">â• Add User</button>
  </div>

  <!-- Add/Edit Form -->
  <div class="collapse" id="formSection">
    <form id="userForm" class="row g-2 mb-4 mt-2">
      <div class="col-md-4">
        <input type="text" id="name" class="form-control" placeholder="ğŸ‘¤ Name" required>
      </div>
      <div class="col-md-4">
        <input type="email" id="email" class="form-control" placeholder="ğŸ“§ Email" required>
      </div>
      <div class="col-md-3">
        <input type="file" id="avatar" accept="image/*" class="form-control">
      </div>
      <div class="col-md-1">
        <button type="submit" class="btn btn-success w-100">ğŸ’¾</button>
      </div>
    </form>
  </div>

  <!-- Users Grid -->
  <div class="row" id="userGrid"></div>
</div>

<script>
  let users = [];
  let editIndex = -1;
  const userForm = document.getElementById('userForm');
  const userGrid = document.getElementById('userGrid');
  const search = document.getElementById('search');

  userForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const name = document.getElementById('name').value.trim();
    const email = document.getElementById('email').value.trim();
    const avatarFile = document.getElementById('avatar').files[0];

    // Duplicate check
    const duplicate = users.some((u, i) => i !== editIndex && (u.name === name || u.email === email));
    if (duplicate) {
      alert('âš ï¸ Duplicate Name or Email not allowed!');
      return;
    }

    const reader = new FileReader();
    reader.onload = (event) => {
      const avatar = avatarFile ? event.target.result : 'https://via.placeholder.com/90';
      if (editIndex === -1) {
        users.push({ name, email, avatar, favorite: false });
      } else {
        users[editIndex] = { ...users[editIndex], name, email, avatar };
        editIndex = -1;
      }
      userForm.reset();
      renderUsers();
    };
    if (avatarFile) reader.readAsDataURL(avatarFile);
    else {
      if (editIndex === -1)
        users.push({ name, email, avatar: 'https://via.placeholder.com/90', favorite: false });
      else {
        users[editIndex] = { ...users[editIndex], name, email };
        editIndex = -1;
      }
      userForm.reset();
      renderUsers();
    }
  });

  function renderUsers() {
    userGrid.innerHTML = '';
    const keyword = search.value.toLowerCase();
    users
      .filter((u) => u.name.toLowerCase().includes(keyword) || u.email.toLowerCase().includes(keyword))
      .forEach((user, index) => {
        const col = document.createElement('div');
        col.className = 'col-md-4 mb-4 animate__animated animate__fadeInUp';
        col.innerHTML = `
          <div class="user-card text-center p-3 position-relative">
            <span class="favorite" onclick="toggleFavorite(${index})">${user.favorite ? 'â¤ï¸' : 'ğŸ¤'}</span>
            <img src="${user.avatar}" class="avatar" alt="avatar">
            <h5 class="mt-2">${user.name}</h5>
            <p class="text-muted">${user.email}</p>
            <div class="d-flex justify-content-center gap-2">
              <button class="btn btn-warning btn-sm" onclick="editUser(${index})">âœï¸ Edit</button>
              <button class="btn btn-danger btn-sm" onclick="deleteUser(${index})">ğŸ—‘ï¸ Delete</button>
            </div>
          </div>
        `;
        userGrid.appendChild(col);
      });
  }

  function toggleFavorite(index) {
    users[index].favorite = !users[index].favorite;
    renderUsers();
  }

  function editUser(index) {
    document.getElementById('name').value = users[index].name;
    document.getElementById('email').value = users[index].email;
    editIndex = index;
    document.getElementById('formSection').classList.add('show');
  }

  function deleteUser(index) {
    if (confirm('ğŸ—‘ï¸ Delete this user?')) {
      users.splice(index, 1);
      renderUsers();
    }
  }

  search.addEventListener('input', renderUsers);
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
